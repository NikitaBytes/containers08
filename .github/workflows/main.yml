name: CI  # –ò–º—è workflow

on:
  push:
    branches:
      - main  # –ó–∞–ø—É—Å–∫–∞—Ç—å CI/CD –ø—Ä–∏ –ø—É—à–µ –≤ main

jobs:
  build:
    runs-on: ubuntu-latest  # –ò—Å–ø–æ–ª—å–∑—É–µ–º GitHub-hosted runner (Ubuntu)

    steps:
      - name: üì• –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
        uses: actions/checkout@v4

      - name: üê≥ –°–æ–±–∏—Ä–∞–µ–º Docker-–æ–±—Ä–∞–∑
        run: docker build -t containers08 .

      - name: üì¶ –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        run: docker create --name container --volume database:/var/www/db containers08

      - name: üìÑ –ö–æ–ø–∏—Ä—É–µ–º —Ç–µ—Å—Ç—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        run: docker cp ./tests container:/var/www/html

      - name: üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        run: docker start container

      - name: ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
        run: docker exec container php /var/www/html/tests/tests.php

      - name: ‚õî –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        run: docker stop container

      - name: üóë –£–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        run: docker rm container
